@model PersonVM
@{
    ViewBag.Title = "Person";
}

@{
    string image_url = "/Images/default_image.png";
    bool IsPhoto = false;
    if (Model.strPersonPhoto != "" && Model.strPersonPhoto != null)
    {
        image_url = "/Images/PersonPhoto/" + Model.strPersonPhoto;
        IsPhoto = true;
    }
}

<section class="wrapper site-min-height">
    <div class="row">
        <div class="col-lg-12">
            <section class="panel">
                <header class="panel-heading">
                    <strong> Update Person Detail </strong>
                </header>
                <div class="panel-body">
                    <div class="form">
                        @using (Html.BeginForm("Edit", "Person", FormMethod.Post, new { @id = "personFormId", @class = "cmxform form-horizontal tasi-form", enctype = "multipart/form-data", role = "form" }))
                        {

                            @Html.AntiForgeryToken()

                        <div class="form-horizontal">

                            @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                            <div class="form-group">
                                @Html.LabelFor(model => model.Firstname, htmlAttributes: new { @class = "control-label col-md-2" })
                                <div class="col-md-10">
                                    @Html.EditorFor(model => model.Firstname, new { htmlAttributes = new { @class = "form-control", maxlength = "150" } })
                                    @Html.ValidationMessageFor(model => model.Firstname, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="form-group">
                                @Html.LabelFor(model => model.Address, htmlAttributes: new { @class = "control-label col-md-2" })
                                <div class="col-md-10">
                                    @Html.TextAreaFor(model => model.Address, 2, 5, new { @class = "form-control", maxlength = "250" })
                                    @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="form-group">
                                @Html.LabelFor(model => model.MobileNo, htmlAttributes: new { @class = "control-label col-md-2" })
                                <div class="col-md-10">
                                    @Html.EditorFor(model => model.MobileNo, new { htmlAttributes = new { @class = "form-control", maxlength = "15" } })
                                </div>
                            </div>

                            <div class="form-group">
                                @Html.LabelFor(model => model.DailyRate, htmlAttributes: new { @class = "control-label col-md-2" })
                                <div class="col-md-10">
                                    @Html.EditorFor(model => model.DailyRate, new { htmlAttributes = new { @class = "form-control", maxlength = "15" } })
                                </div>
                            </div>

                            <div class="form-group">
                                @Html.LabelFor(model => model.PersonTypeId, htmlAttributes: new { @class = "control-label col-md-2" })
                                <div class="col-md-10">
                                    @Html.DropDownList("PersonTypeId", new SelectList(Model.PersonTypeList, "Value", "Text"), "-Select Person Type-", new { @class = "form-control" })
                                    @Html.ValidationMessageFor(m => m.PersonTypeId, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="form-group last">
                                <label class="control-label col-lg-2">Photo</label>
                                <div class="col-lg-10">
                                    <div class="fileupload @(IsPhoto ? "fileupload-exists" : "fileupload-new")" data-provides="fileupload">
                                        <div class="fileupload-new thumbnail" style="width: 200px; height: 150px;">
                                            <img src="@image_url" alt="" />
                                            @Html.HiddenFor(m => m.strPersonPhoto)
                                        </div>
                                        <div class="fileupload-preview fileupload-exists thumbnail" style="max-width: 200px; max-height: 150px; line-height: 20px;">
                                            <img src="@image_url" alt="" />
                                        </div>
                                        <div>
                                            <span class="btn btn-white btn-file">
                                                <span class="fileupload-new clsfileupload-new"><i class="fa fa-paper-clip"></i> Select image</span>
                                                <span class="fileupload-exists clsfileupload-exists"><i class="fa fa-undo"></i> Change</span>
                                                @*<input type="file" class="default" />*@
                                                @Html.TextBoxFor(m => m.PostedFile, new { type = "file", @class = "default" })

                                            </span>
                                            <a href="javascript:void(0);" class="btn btn-danger fileupload-exists clsfileupload-exists clsDeletePhoto" data-dismiss="fileupload"><i class="fa fa-trash"></i> Remove</a>

                                        </div>
                                        @Html.ValidationMessageFor(m => m.PostedFile, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="col-md-offset-2 col-md-10">
                                    @Html.HiddenFor(m => m.PersonId)
                                    <input id="cmdSubmit" type="submit" value="Update" class="btn btn-success" />
                                    <button class="btn btn-default" id="btnCancel" type="button">Cancel</button>
                                </div>
                            </div>
                        </div>
                        }

                    </div>
                </div>
            </section>
        </div>
    </div>
</section>

<script src="~/Areas/Admin/Content/js/jquery.js"></script>

<script>

    jQuery(document).ready(function () {
        jQuery('html, body').animate({ scrollTop: 0 }, 1000);
    });

    jQuery(document).on("click", "#btnCancel", function () {
        window.location.href = '/admin/person';
    });

    jQuery(document).on("click", ".clsDeletePhoto", function () {
        jQuery(".fileupload img").attr("src", "/Images/default_image.png");
        jQuery("#strPersonPhoto").val("");
    });

    jQuery("#cmdSubmit").click(function (event) {
        //event.preventDefault();
        if (jQuery("form").valid()) {
            jQuery.blockUI({ message: "<h4>Please Wait...</h4>" });
        }
    });

</script>